{
  "title": "Using Serverless Redis with Next.js",
  "publishedAt": "2021-03-19",
  "summary": "Did you know it's possible to use Redis for your entire database? Hashmaps, counters, sorted lists, and even queues. Learn how to deploy a Redis & Next.js app in a few short minutes.",
  "body": {
    "raw": "\nWhen front-end developers are learning the full-stack, they often stumble on which [backend to use](/blog/backend). If they hear Redis, they think of in-memory caching. That's what I thought, at least.\nAfter doing more research, I was surprised to find Redis excels at [hashmaps, counters, sorted lists, and even queues](http://oldblog.antirez.com/post/take-advantage-of-redis-adding-it-to-your-stack.html). It's possible to use Redis for your entire database!\n\nThis article will explore using Redis with Next.js in Serverless environments.\n\n### Creating a Redis Instance\n\n[Upstash](https://upstash.com/) is the easiest way I've found to deploy a managed Redis instance. A few reasons I recommend it:\n\n- There's a generous free tier, and then per-request pricing when you're ready to upgrade. This keeps costs free (or extremely low). There's even a $120/month cap to prevent surprises, plus reserved plans for larger projects.\n- With Upstash, you can use Redis for more than just caching with durable storage. There's even [Strong Consistency](https://docs.upstash.com/docs/overall/consistency) mode for guaranteed, durable writes.\n- It's fast. Really, really fast. Extremely low latency.\n\nThe Upstash Integration for Vercel makes it easy to get started with Serverless Redis. We'll start by deploying the [completed project](https://roadmap-redis.vercel.app/), and then running the application locally.\n\n1. [Deploy the demo to Vercel using the Upstash Integration.](https://vercel.com/new/git/external?repository-url=https%3A%2F%2Fgithub.com%2Fvercel%2Fnext.js%2Ftree%2Fcanary%2Fexamples%2Fwith-redis&project-name=redis-roadmap&repository-name=redis-roadmap&demo-title=Redis%20Roadmap&demo-description=Create%20and%20upvote%20features%20for%20your%20product.&demo-url=https%3A%2F%2Froadmap-redis.vercel.app%2F&integration-ids=oac_V3R1GIpkoJorr6fqyiwdhl17)\n2. You'll be prompted to sign-up or sign-in to Upstash.\n3. Then, you can create a free database and attach it to your Vercel project.\n4. Click \"Complete on Vercel\".\n5. That's it! You should have a deployed project and URL.\n\nBy default, both Vercel and Upstash use the `us-east-1` region for Serverless Functions. Using the same region is critical to minimize latency between your [Serverless Functions](https://vercel.com/docs/serverless-functions/introduction) and Redis.\n\n### Connecting to Redis\n\nIf you're using Vercel, you can clone the git repository created during deployment.\nThe `REDIS_URL` environment variable was added by the Upstash Integration while deploying. To run the application locally, we'll need to pull our environment variables locally using the [Vercel CLI](https://vercel.com/download).\n\n```jsx\n$ vercel link\n$ vercel env pull .env.local\n```\n\nIf you're not using Vercel, you can clone this demo locally using `npx create-next-app --example with-redis roadmap`.\nThen, create an `.env.local` file in the root of your repository and add the Redis connection string.\n\n```jsx:.env.local\nREDIS_URL=redis://:password@endpoint:port\n```\n\nWe'll use [ioredis](https://github.com/luin/ioredis), a Node.js Redis client with [async/await](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function) support, to connect to Redis.\n\n```jsx title=\"lib/redis.js\"\nimport Redis from 'ioredis';\n\nconst redis = new Redis(process.env.REDIS_URL);\n\nexport default redis;\n```\n\nFinally, we can use this inside any page or API Route to retrieve information from Redis.\n\n```jsx\nimport redis from 'lib/redis';\n\nconst value = JSON.parse(await redis.hget('feedback', id));\n```\n\n### Using Redis with Next.js\n\nHere's a few common Redis commands you might need to use:\n\n- Fetching a JSON object: `redis.hget('feedback', id)`\n- Creating a JSON object: `redis.hset('feedback', id, \"{'key': 'val'}\")`\n- Deleting by key: `redis.hdel('feedback', id)`\n- Fetching a list of items: `redis.hvals('feedback')`\n\nIn the demo application, we use Redis for the following:\n\n1. The feature list is server-rendered using `getServerSideProps`. We fetch all features and sort based on the score and title.\n1. The initial feature list from the server populates the local cache of [SWR](swr.vercel.app). This ensures data remains up-to-date on the client-side.\n1. When adding features or emails, a `POST` request is sent to an [API Route](https://nextjs.org/docs/api-routes/introduction) to update Redis.\n1. Adding/upvoting features will mutate the client-side cache for [optimistic UI updates](https://swr.vercel.app/docs/mutation).\n\nYou can view the entire Redis API [here](https://redis.io/commands). For more advanced Redis usage, see the Redis API compatibility with Upstash [here](https://docs.upstash.com/docs/overall/rediscompatibility/).\n\n### Conclusion\n\nI frequently need to store data, somewhere. It doesn't always need to be complex â€“ a key/value store will often suffice.\nAfter working more with Upstash, Redis is now my preferred solution for this (and apparently [many other people's as well](https://www.freecodecamp.org/news/stack-overflow-developer-survey-2020-programming-language-framework-salary-data/)).\n\n- [View the demo âœ¨](https://roadmap-redis.vercel.app/)\n- [Deploy your own ðŸš€](https://vercel.com/new/git/external?repository-url=https%3A%2F%2Fgithub.com%2Fvercel%2Fnext.js%2Ftree%2Fcanary%2Fexamples%2Fwith-redis&project-name=redis-roadmap&repository-name=redis-roadmap&demo-title=Redis%20Roadmap&demo-description=Create%20and%20upvote%20features%20for%20your%20product.&demo-url=https%3A%2F%2Froadmap-redis.vercel.app%2F&integration-ids=oac_V3R1GIpkoJorr6fqyiwdhl17)\n\n**Bonus:** If you need to inspect your Redis database locally, check out [TablePlus](https://tableplus.com/) for a GUI and [redis-cli](https://docs.upstash.com/docs/overall/getstarted#connect-to-your-database) if you prefer the command-line.\n",
    "code": "var Component=(()=>{var h=Object.create;var s=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var B=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),f=(r,e)=>{for(var l in e)s(r,l,{get:e[l],enumerable:!0})},o=(r,e,l,a)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let t of y(e))!m.call(r,t)&&t!==l&&s(r,t,{get:()=>e[t],enumerable:!(a=p(e,t))||a.enumerable});return r};var g=(r,e,l)=>(l=r!=null?h(u(r)):{},o(e||!r||!r.__esModule?s(l,\"default\",{value:r,enumerable:!0}):l,r)),F=r=>o(s({},\"__esModule\",{value:!0}),r);var c=B((R,i)=>{i.exports=_jsx_runtime});var A={};f(A,{default:()=>b,frontmatter:()=>v});var n=g(c()),v={title:\"Using Serverless Redis with Next.js\",publishedAt:\"2021-03-19\",summary:\"Did you know it's possible to use Redis for your entire database? Hashmaps, counters, sorted lists, and even queues. Learn how to deploy a Redis & Next.js app in a few short minutes.\"};function d(r){let e=Object.assign({p:\"p\",a:\"a\",h3:\"h3\",span:\"span\",ul:\"ul\",li:\"li\",ol:\"ol\",code:\"code\",div:\"div\",pre:\"pre\",strong:\"strong\"},r.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[\"When front-end developers are learning the full-stack, they often stumble on which \",(0,n.jsx)(e.a,{href:\"/blog/backend\",children:\"backend to use\"}),`. If they hear Redis, they think of in-memory caching. That's what I thought, at least.\nAfter doing more research, I was surprised to find Redis excels at `,(0,n.jsx)(e.a,{href:\"http://oldblog.antirez.com/post/take-advantage-of-redis-adding-it-to-your-stack.html\",children:\"hashmaps, counters, sorted lists, and even queues\"}),\". It's possible to use Redis for your entire database!\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This article will explore using Redis with Next.js in Serverless environments.\"}),`\n`,(0,n.jsxs)(e.h3,{id:\"creating-a-redis-instance\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#creating-a-redis-instance\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Creating a Redis Instance\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.a,{href:\"https://upstash.com/\",children:\"Upstash\"}),\" is the easiest way I've found to deploy a managed Redis instance. A few reasons I recommend it:\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"There's a generous free tier, and then per-request pricing when you're ready to upgrade. This keeps costs free (or extremely low). There's even a $120/month cap to prevent surprises, plus reserved plans for larger projects.\"}),`\n`,(0,n.jsxs)(e.li,{children:[\"With Upstash, you can use Redis for more than just caching with durable storage. There's even \",(0,n.jsx)(e.a,{href:\"https://docs.upstash.com/docs/overall/consistency\",children:\"Strong Consistency\"}),\" mode for guaranteed, durable writes.\"]}),`\n`,(0,n.jsx)(e.li,{children:\"It's fast. Really, really fast. Extremely low latency.\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"The Upstash Integration for Vercel makes it easy to get started with Serverless Redis. We'll start by deploying the \",(0,n.jsx)(e.a,{href:\"https://roadmap-redis.vercel.app/\",children:\"completed project\"}),\", and then running the application locally.\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://vercel.com/new/git/external?repository-url=https%3A%2F%2Fgithub.com%2Fvercel%2Fnext.js%2Ftree%2Fcanary%2Fexamples%2Fwith-redis&project-name=redis-roadmap&repository-name=redis-roadmap&demo-title=Redis%20Roadmap&demo-description=Create%20and%20upvote%20features%20for%20your%20product.&demo-url=https%3A%2F%2Froadmap-redis.vercel.app%2F&integration-ids=oac_V3R1GIpkoJorr6fqyiwdhl17\",children:\"Deploy the demo to Vercel using the Upstash Integration.\"})}),`\n`,(0,n.jsx)(e.li,{children:\"You'll be prompted to sign-up or sign-in to Upstash.\"}),`\n`,(0,n.jsx)(e.li,{children:\"Then, you can create a free database and attach it to your Vercel project.\"}),`\n`,(0,n.jsx)(e.li,{children:'Click \"Complete on Vercel\".'}),`\n`,(0,n.jsx)(e.li,{children:\"That's it! You should have a deployed project and URL.\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"By default, both Vercel and Upstash use the \",(0,n.jsx)(e.code,{children:\"us-east-1\"}),\" region for Serverless Functions. Using the same region is critical to minimize latency between your \",(0,n.jsx)(e.a,{href:\"https://vercel.com/docs/serverless-functions/introduction\",children:\"Serverless Functions\"}),\" and Redis.\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"connecting-to-redis\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#connecting-to-redis\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Connecting to Redis\"]}),`\n`,(0,n.jsxs)(e.p,{children:[`If you're using Vercel, you can clone the git repository created during deployment.\nThe `,(0,n.jsx)(e.code,{children:\"REDIS_URL\"}),\" environment variable was added by the Upstash Integration while deploying. To run the application locally, we'll need to pull our environment variables locally using the \",(0,n.jsx)(e.a,{href:\"https://vercel.com/download\",children:\"Vercel CLI\"}),\".\"]}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"jsx\",\"data-theme\":\"default\",children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"$\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"vercel\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"link\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"$\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"vercel\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"env\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"pull\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" .\"}),(0,n.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"env\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"local\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"If you're not using Vercel, you can clone this demo locally using \",(0,n.jsx)(e.code,{children:\"npx create-next-app --example with-redis roadmap\"}),`.\nThen, create an `,(0,n.jsx)(e.code,{children:\".env.local\"}),\" file in the root of your repository and add the Redis connection string.\"]}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"jsx:.env.local\",\"data-theme\":\"default\",children:(0,n.jsx)(e.code,{\"data-language\":\"jsx:.env.local\",\"data-theme\":\"default\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#abb2bf\"},children:\"REDIS_URL=redis://:password@endpoint:port\"})})})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"We'll use \",(0,n.jsx)(e.a,{href:\"https://github.com/luin/ioredis\",children:\"ioredis\"}),\", a Node.js Redis client with \",(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function\",children:\"async/await\"}),\" support, to connect to Redis.\"]}),`\n`,(0,n.jsxs)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:[(0,n.jsx)(e.div,{\"data-rehype-pretty-code-title\":\"\",\"data-language\":\"jsx\",\"data-theme\":\"default\",children:\"lib/redis.js\"}),(0,n.jsx)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"jsx\",\"data-theme\":\"default\",children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"Redis\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#98C379\"},children:\"'ioredis'\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"const\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"redis\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"new\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"Redis\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"process\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"env\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"REDIS_URL\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"export\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"default\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"redis\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\";\"})]})]})})]}),`\n`,(0,n.jsx)(e.p,{children:\"Finally, we can use this inside any page or API Route to retrieve information from Redis.\"}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"jsx\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"jsx\",\"data-theme\":\"default\",children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"redis\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#98C379\"},children:\"'lib/redis'\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"const\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"value\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"JSON\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"parse\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"await\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"redis\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"hget\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#98C379\"},children:\"'feedback'\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"id\"}),(0,n.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"));\"})]})]})})}),`\n`,(0,n.jsxs)(e.h3,{id:\"using-redis-with-nextjs\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#using-redis-with-nextjs\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Using Redis with Next.js\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Here's a few common Redis commands you might need to use:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Fetching a JSON object: \",(0,n.jsx)(e.code,{children:\"redis.hget('feedback', id)\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Creating a JSON object: \",(0,n.jsx)(e.code,{children:`redis.hset('feedback', id, \"{'key': 'val'}\")`})]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Deleting by key: \",(0,n.jsx)(e.code,{children:\"redis.hdel('feedback', id)\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Fetching a list of items: \",(0,n.jsx)(e.code,{children:\"redis.hvals('feedback')\"})]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"In the demo application, we use Redis for the following:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"The feature list is server-rendered using \",(0,n.jsx)(e.code,{children:\"getServerSideProps\"}),\". We fetch all features and sort based on the score and title.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"The initial feature list from the server populates the local cache of \",(0,n.jsx)(e.a,{href:\"swr.vercel.app\",children:\"SWR\"}),\". This ensures data remains up-to-date on the client-side.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"When adding features or emails, a \",(0,n.jsx)(e.code,{children:\"POST\"}),\" request is sent to an \",(0,n.jsx)(e.a,{href:\"https://nextjs.org/docs/api-routes/introduction\",children:\"API Route\"}),\" to update Redis.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Adding/upvoting features will mutate the client-side cache for \",(0,n.jsx)(e.a,{href:\"https://swr.vercel.app/docs/mutation\",children:\"optimistic UI updates\"}),\".\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"You can view the entire Redis API \",(0,n.jsx)(e.a,{href:\"https://redis.io/commands\",children:\"here\"}),\". For more advanced Redis usage, see the Redis API compatibility with Upstash \",(0,n.jsx)(e.a,{href:\"https://docs.upstash.com/docs/overall/rediscompatibility/\",children:\"here\"}),\".\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"conclusion\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#conclusion\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,n.jsxs)(e.p,{children:[`I frequently need to store data, somewhere. It doesn't always need to be complex \\u2013 a key/value store will often suffice.\nAfter working more with Upstash, Redis is now my preferred solution for this (and apparently `,(0,n.jsx)(e.a,{href:\"https://www.freecodecamp.org/news/stack-overflow-developer-survey-2020-programming-language-framework-salary-data/\",children:\"many other people's as well\"}),\").\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://roadmap-redis.vercel.app/\",children:\"View the demo \\u2728\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://vercel.com/new/git/external?repository-url=https%3A%2F%2Fgithub.com%2Fvercel%2Fnext.js%2Ftree%2Fcanary%2Fexamples%2Fwith-redis&project-name=redis-roadmap&repository-name=redis-roadmap&demo-title=Redis%20Roadmap&demo-description=Create%20and%20upvote%20features%20for%20your%20product.&demo-url=https%3A%2F%2Froadmap-redis.vercel.app%2F&integration-ids=oac_V3R1GIpkoJorr6fqyiwdhl17\",children:\"Deploy your own \\u{1F680}\"})}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Bonus:\"}),\" If you need to inspect your Redis database locally, check out \",(0,n.jsx)(e.a,{href:\"https://tableplus.com/\",children:\"TablePlus\"}),\" for a GUI and \",(0,n.jsx)(e.a,{href:\"https://docs.upstash.com/docs/overall/getstarted#connect-to-your-database\",children:\"redis-cli\"}),\" if you prefer the command-line.\"]})]})}function w(r={}){let{wrapper:e}=r.components||{};return e?(0,n.jsx)(e,Object.assign({},r,{children:(0,n.jsx)(d,r)})):d(r)}var b=w;return F(A);})();\n;return Component;"
  },
  "_id": "serverless-redis-nextjs.mdx",
  "_raw": {
    "sourceFilePath": "serverless-redis-nextjs.mdx",
    "sourceFileName": "serverless-redis-nextjs.mdx",
    "sourceFileDir": ".",
    "contentType": "mdx",
    "flattenedPath": "serverless-redis-nextjs"
  },
  "type": "Blog",
  "slug": "serverless-redis-nextjs",
  "tweetIds": [],
  "structuredData": {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "Using Serverless Redis with Next.js",
    "datePublished": "2021-03-19",
    "dateModified": "2021-03-19",
    "description": "Did you know it's possible to use Redis for your entire database? Hashmaps, counters, sorted lists, and even queues. Learn how to deploy a Redis & Next.js app in a few short minutes.",
    "image": "https://homescree.net/og?title=Using Serverless Redis with Next.js",
    "url": "https://homescree.net/blog/serverless-redis-nextjs",
    "author": {
      "@type": "Person",
      "name": "Matthew Guo"
    }
  }
}