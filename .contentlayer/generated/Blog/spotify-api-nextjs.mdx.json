{
  "title": "Using the Spotify API with Next.js",
  "publishedAt": "2020-07-21",
  "summary": "Learn how to authenticate with the Spotify API to fetch your top tracks in a Next.js API route.",
  "body": {
    "raw": "\nI wanted to display what song I'm currently listening to on my site, as well as my top tracks.\nTo accomplish this, I'd need to integrate [Spotify's API](https://developer.spotify.com/documentation/web-api/) with Next.js [API routes](https://nextjs.org/docs/api-routes/introduction).\nThis post will be a quick tutorial to get up and running with Spotify.\n\n## Create an Application\n\nFirst, we need to create a Spotify application to give us credentials to authenticate with the API.\n\n- Go to your [Spotify Developer Dashboard](https://developer.spotify.com/dashboard/) and log in.\n- Click **Create an App**.\n- Fill out the name and description and click **create**.\n- Click **Show Client Secret**.\n- Save your Client ID and Secret. You'll need these soon.\n- Click **Edit Settings**.\n- Add `http://localhost:3000` as a redirect URI.\n\nAll done! You now have a properly configured Spotify application and the correct credentials to make requests.\n\n## Authentication\n\nThere are a variety of ways to authenticate with the Spotify API, depending on your application. Since we only need permission granted _once_, we'll use the [Authorization Code Flow](https://developer.spotify.com/documentation/general/guides/authorization-guide/#authorization-code-flow).\n\nFirst, we'll have our application request authorization by logging in with whatever [scopes](https://developer.spotify.com/documentation/general/guides/authorization-guide/#list-of-scopes) we need.\nHere's an example of what the URL might look like.\nSwap out the `client_id` and scopes for your own.\n\n```bash\nhttps://accounts.spotify.com/authorize?client_id=8e94bde7dd\nb84a1f7a0e51bf3bc95be8&response_type=code&redirect_uri=http\n%3A%2F%2Flocalhost:3000&scope=user-read-currently-playing%20\nuser-top-read\n```\n\nAfter authorizing, you'll be redirected back to your `redirect_uri`.\nIn the URL, there's a `code` query parameter. Save this value.\n\n```bash\nhttp://localhost:3000/callback?code=NApCCg..BkWtQ\n```\n\nNext, we'll need to retrieve the refresh token. You'll need to generate a Base 64 encoded string containing the client ID and secret from earlier. You can use [this tool](https://www.base64encode.org/) to encode it online. The format should be `client_id:client_secret`.\n\n```bash\ncurl -H \"Authorization: Basic <base64 encoded client_id:client_secret>\"\n-d grant_type=authorization_code -d code=<code> -d redirect_uri=http%3A\n%2F%2Flocalhost:3000 https://accounts.spotify.com/api/token\n```\n\nThis will return a JSON response containing a `refresh_token`. This token is [valid indefinitely](https://github.com/spotify/web-api/issues/374) unless you revoke access, so we'll want to save this in an environment variable.\n\n## Using Spotify's API\n\nFinally, we can get some real data! Inside Next.js, create three new values in your `.env.local` file.\n\n```bash\nSPOTIFY_CLIENT_ID=\nSPOTIFY_CLIENT_SECRET=\nSPOTIFY_REFRESH_TOKEN=\n```\n\n**Note:** If you haven't worked with environment variables in Next before, [give this a read first](https://nextjs.org/docs/basic-features/environment-variables).\n\nWe can now request an access token using our client ID, client secret, and `refresh_token`.\n\n```js title=\"lib/spotify.js\"\nimport querystring from 'querystring';\n\nconst client_id = process.env.SPOTIFY_CLIENT_ID;\nconst client_secret = process.env.SPOTIFY_CLIENT_SECRET;\nconst refresh_token = process.env.SPOTIFY_REFRESH_TOKEN;\n\nconst basic = Buffer.from(`${client_id}:${client_secret}`).toString('base64');\nconst TOKEN_ENDPOINT = `https://accounts.spotify.com/api/token`;\n\nconst getAccessToken = async () => {\n  const response = await fetch(TOKEN_ENDPOINT, {\n    method: 'POST',\n    headers: {\n      Authorization: `Basic ${basic}`,\n      'Content-Type': 'application/x-www-form-urlencoded',\n    },\n    body: querystring.stringify({\n      grant_type: 'refresh_token',\n      refresh_token,\n    }),\n  });\n\n  return response.json();\n};\n```\n\nUse this `access_token` to securely request your top tracks.\nThis assumes you added the `user-top-read` scope at the beginning.\n\n```js title=\"lib/spotify.js\"\nconst TOP_TRACKS_ENDPOINT = `https://api.spotify.com/v1/me/top/tracks`;\n\nexport const getTopTracks = async () => {\n  const { access_token } = await getAccessToken();\n\n  return fetch(TOP_TRACKS_ENDPOINT, {\n    headers: {\n      Authorization: `Bearer ${access_token}`,\n    },\n  });\n};\n```\n\n### Creating an API Route\n\nLet's test our communication with Spotify.\nFirst, create a new file at `pages/api/top-tracks.js`.\nThen, import the new function `getTopTracks`.\n\n```js title=\"pages/api/top-tracks.js\"\nimport { getTopTracks } from '../../lib/spotify';\n\nexport default async (_, res) => {\n  const response = await getTopTracks();\n  const { items } = await response.json();\n\n  const tracks = items.slice(0, 10).map((track) => ({\n    artist: track.artists.map((_artist) => _artist.name).join(', '),\n    songUrl: track.external_urls.spotify,\n    title: track.name,\n  }));\n\n  return res.status(200).json({ tracks });\n};\n```\n\nThis will return the first ten top tracks, formatted to remove unnecessary information.\nFeel free to modify this as you see fit.\nIf everything worked correctly, you should see some data like this after running `next dev`.\n\n```json\n{\n  \"tracks\": [\n    {\n      \"artist\": \"Jamie xx\",\n      \"songUrl\": \"https://open.spotify.com/track/77Ezu3tBE7gmzQ4mRnZZUf\",\n      \"title\": \"The Rest Is Noise\"\n    },\n    {\n      \"artist\": \"Surfaces\",\n      \"songUrl\": \"https://open.spotify.com/track/0NjSiGW8b5HYFfjdCbZzbg\",\n      \"title\": \"Horizons\"\n    }\n  ]\n}\n```\n\n## Conclusion\n\nThe full source code is available [here](https://github.com/leerob/leerob.io/blob/675ba074e873a85f1ee6a0d195f7d20312e62b4e/lib/spotify.ts).\n",
    "code": "var Component=(()=>{var h=Object.create;var s=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var y=Object.getPrototypeOf,F=Object.prototype.hasOwnProperty;var A=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),C=(n,e)=>{for(var r in e)s(n,r,{get:e[r],enumerable:!0})},a=(n,e,r,o)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let c of B(e))!F.call(n,c)&&c!==r&&s(n,c,{get:()=>e[c],enumerable:!(o=p(e,c))||o.enumerable});return n};var u=(n,e,r)=>(r=n!=null?h(y(n)):{},a(e||!n||!n.__esModule?s(r,\"default\",{value:n,enumerable:!0}):r,n)),g=n=>a(s({},\"__esModule\",{value:!0}),n);var i=A((k,t)=>{t.exports=_jsx_runtime});var D={};C(D,{default:()=>m,frontmatter:()=>f});var l=u(i()),f={title:\"Using the Spotify API with Next.js\",publishedAt:\"2020-07-21\",summary:\"Learn how to authenticate with the Spotify API to fetch your top tracks in a Next.js API route.\"};function d(n){let e=Object.assign({p:\"p\",a:\"a\",h2:\"h2\",span:\"span\",ul:\"ul\",li:\"li\",strong:\"strong\",code:\"code\",em:\"em\",div:\"div\",pre:\"pre\",h3:\"h3\"},n.components);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(e.p,{children:[`I wanted to display what song I'm currently listening to on my site, as well as my top tracks.\nTo accomplish this, I'd need to integrate `,(0,l.jsx)(e.a,{href:\"https://developer.spotify.com/documentation/web-api/\",children:\"Spotify's API\"}),\" with Next.js \",(0,l.jsx)(e.a,{href:\"https://nextjs.org/docs/api-routes/introduction\",children:\"API routes\"}),`.\nThis post will be a quick tutorial to get up and running with Spotify.`]}),`\n`,(0,l.jsxs)(e.h2,{id:\"create-an-application\",children:[(0,l.jsx)(e.a,{className:\"anchor\",href:\"#create-an-application\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Create an Application\"]}),`\n`,(0,l.jsx)(e.p,{children:\"First, we need to create a Spotify application to give us credentials to authenticate with the API.\"}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsxs)(e.li,{children:[\"Go to your \",(0,l.jsx)(e.a,{href:\"https://developer.spotify.com/dashboard/\",children:\"Spotify Developer Dashboard\"}),\" and log in.\"]}),`\n`,(0,l.jsxs)(e.li,{children:[\"Click \",(0,l.jsx)(e.strong,{children:\"Create an App\"}),\".\"]}),`\n`,(0,l.jsxs)(e.li,{children:[\"Fill out the name and description and click \",(0,l.jsx)(e.strong,{children:\"create\"}),\".\"]}),`\n`,(0,l.jsxs)(e.li,{children:[\"Click \",(0,l.jsx)(e.strong,{children:\"Show Client Secret\"}),\".\"]}),`\n`,(0,l.jsx)(e.li,{children:\"Save your Client ID and Secret. You'll need these soon.\"}),`\n`,(0,l.jsxs)(e.li,{children:[\"Click \",(0,l.jsx)(e.strong,{children:\"Edit Settings\"}),\".\"]}),`\n`,(0,l.jsxs)(e.li,{children:[\"Add \",(0,l.jsx)(e.code,{children:\"http://localhost:3000\"}),\" as a redirect URI.\"]}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"All done! You now have a properly configured Spotify application and the correct credentials to make requests.\"}),`\n`,(0,l.jsxs)(e.h2,{id:\"authentication\",children:[(0,l.jsx)(e.a,{className:\"anchor\",href:\"#authentication\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Authentication\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"There are a variety of ways to authenticate with the Spotify API, depending on your application. Since we only need permission granted \",(0,l.jsx)(e.em,{children:\"once\"}),\", we'll use the \",(0,l.jsx)(e.a,{href:\"https://developer.spotify.com/documentation/general/guides/authorization-guide/#authorization-code-flow\",children:\"Authorization Code Flow\"}),\".\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"First, we'll have our application request authorization by logging in with whatever \",(0,l.jsx)(e.a,{href:\"https://developer.spotify.com/documentation/general/guides/authorization-guide/#list-of-scopes\",children:\"scopes\"}),` we need.\nHere's an example of what the URL might look like.\nSwap out the `,(0,l.jsx)(e.code,{children:\"client_id\"}),\" and scopes for your own.\"]}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.code,{\"data-language\":\"bash\",\"data-theme\":\"default\",children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"https://accounts.spotify.com/authorize?client_id\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"=8e94bde7dd\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"b84a1f7a0e51bf3bc95be8\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"response_type\"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"code\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"redirect_uri\"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"http\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"%3A%2F%2Flocalhost:3000\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"&\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"scope\"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"user-read-currently-playing%20\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"user-top-read\"})})]})})}),`\n`,(0,l.jsxs)(e.p,{children:[\"After authorizing, you'll be redirected back to your \",(0,l.jsx)(e.code,{children:\"redirect_uri\"}),`.\nIn the URL, there's a `,(0,l.jsx)(e.code,{children:\"code\"}),\" query parameter. Save this value.\"]}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",children:(0,l.jsx)(e.code,{\"data-language\":\"bash\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"http://localhost:3000/callback?code\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"=NApCCg..BkWtQ\"})]})})})}),`\n`,(0,l.jsxs)(e.p,{children:[\"Next, we'll need to retrieve the refresh token. You'll need to generate a Base 64 encoded string containing the client ID and secret from earlier. You can use \",(0,l.jsx)(e.a,{href:\"https://www.base64encode.org/\",children:\"this tool\"}),\" to encode it online. The format should be \",(0,l.jsx)(e.code,{children:\"client_id:client_secret\"}),\".\"]}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.code,{\"data-language\":\"bash\",\"data-theme\":\"default\",children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"curl\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#D19A66\"},children:\"-H\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:'\"Authorization: Basic <base64 encoded client_id:client_secret>\"'})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"-d\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"grant_type=authorization_code\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#D19A66\"},children:\"-d\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"code=\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"cod\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"e> \"}),(0,l.jsx)(e.span,{style:{color:\"#D19A66\"},children:\"-d\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"redirect_uri=http%3A\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"%2F%2Flocalhost:3000\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"https://accounts.spotify.com/api/token\"})]})]})})}),`\n`,(0,l.jsxs)(e.p,{children:[\"This will return a JSON response containing a \",(0,l.jsx)(e.code,{children:\"refresh_token\"}),\". This token is \",(0,l.jsx)(e.a,{href:\"https://github.com/spotify/web-api/issues/374\",children:\"valid indefinitely\"}),\" unless you revoke access, so we'll want to save this in an environment variable.\"]}),`\n`,(0,l.jsxs)(e.h2,{id:\"using-spotifys-api\",children:[(0,l.jsx)(e.a,{className:\"anchor\",href:\"#using-spotifys-api\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Using Spotify's API\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Finally, we can get some real data! Inside Next.js, create three new values in your \",(0,l.jsx)(e.code,{children:\".env.local\"}),\" file.\"]}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.code,{\"data-language\":\"bash\",\"data-theme\":\"default\",children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"SPOTIFY_CLIENT_ID\"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"SPOTIFY_CLIENT_SECRET\"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"SPOTIFY_REFRESH_TOKEN\"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"})]})]})})}),`\n`,(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:\"Note:\"}),\" If you haven't worked with environment variables in Next before, \",(0,l.jsx)(e.a,{href:\"https://nextjs.org/docs/basic-features/environment-variables\",children:\"give this a read first\"}),\".\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"We can now request an access token using our client ID, client secret, and \",(0,l.jsx)(e.code,{children:\"refresh_token\"}),\".\"]}),`\n`,(0,l.jsxs)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:[(0,l.jsx)(e.div,{\"data-rehype-pretty-code-title\":\"\",\"data-language\":\"js\",\"data-theme\":\"default\",children:\"lib/spotify.js\"}),(0,l.jsx)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.code,{\"data-language\":\"js\",\"data-theme\":\"default\",children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"import\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"querystring\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"from\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"'querystring'\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"client_id\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"process\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"env\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"SPOTIFY_CLIENT_ID\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"client_secret\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"process\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"env\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"SPOTIFY_CLIENT_SECRET\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"refresh_token\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"process\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"env\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"SPOTIFY_REFRESH_TOKEN\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"basic\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"Buffer\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"from\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"`\"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"${\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"client_id\"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"}\"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"${\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"client_secret\"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"}\"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"`\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\").\"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"toString\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"'base64'\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\");\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"TOKEN_ENDPOINT\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"`https://accounts.spotify.com/api/token`\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"getAccessToken\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"async\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" () \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"response\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"await\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"fetch\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"TOKEN_ENDPOINT\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\", {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"method\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"'POST'\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"headers\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"Authorization\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"`Basic \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"${\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"basic\"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"}\"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"`\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"'Content-Type'\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"'application/x-www-form-urlencoded'\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"    },\"})}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"body\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"querystring\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"stringify\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"({\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"grant_type\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"'refresh_token'\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"refresh_token\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"    }),\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"  });\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"return\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"response\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"json\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"();\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"};\"})})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Use this \",(0,l.jsx)(e.code,{children:\"access_token\"}),` to securely request your top tracks.\nThis assumes you added the `,(0,l.jsx)(e.code,{children:\"user-top-read\"}),\" scope at the beginning.\"]}),`\n`,(0,l.jsxs)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:[(0,l.jsx)(e.div,{\"data-rehype-pretty-code-title\":\"\",\"data-language\":\"js\",\"data-theme\":\"default\",children:\"lib/spotify.js\"}),(0,l.jsx)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.code,{\"data-language\":\"js\",\"data-theme\":\"default\",children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"TOP_TRACKS_ENDPOINT\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"`https://api.spotify.com/v1/me/top/tracks`\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"export\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"getTopTracks\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"async\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" () \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" { \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"access_token\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" } \"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"await\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"getAccessToken\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"();\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"return\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"fetch\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"TOP_TRACKS_ENDPOINT\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\", {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"headers\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"Authorization\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"`Bearer \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"${\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"access_token\"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"}\"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"`\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"    },\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"  });\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"};\"})})]})})]}),`\n`,(0,l.jsxs)(e.h3,{id:\"creating-an-api-route\",children:[(0,l.jsx)(e.a,{className:\"anchor\",href:\"#creating-an-api-route\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Creating an API Route\"]}),`\n`,(0,l.jsxs)(e.p,{children:[`Let's test our communication with Spotify.\nFirst, create a new file at `,(0,l.jsx)(e.code,{children:\"pages/api/top-tracks.js\"}),`.\nThen, import the new function `,(0,l.jsx)(e.code,{children:\"getTopTracks\"}),\".\"]}),`\n`,(0,l.jsxs)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:[(0,l.jsx)(e.div,{\"data-rehype-pretty-code-title\":\"\",\"data-language\":\"js\",\"data-theme\":\"default\",children:\"pages/api/top-tracks.js\"}),(0,l.jsx)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.code,{\"data-language\":\"js\",\"data-theme\":\"default\",children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"import\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" { \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"getTopTracks\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" } \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"from\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"'../../lib/spotify'\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\";\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"export\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"default\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"async\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" (\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"_\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"res\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"response\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"await\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"getTopTracks\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"();\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" { \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"items\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" } \"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"await\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"response\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"json\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"();\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"tracks\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"items\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"slice\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#D19A66\"},children:\"0\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#D19A66\"},children:\"10\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\").\"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"map\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"((\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"track\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" ({\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"artist\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"track\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"artists\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"map\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"((\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"_artist\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"_artist\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\").\"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"join\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:\"', '\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"),\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"songUrl\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"track\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"external_urls\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"spotify\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"title\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"track\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"  }));\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#C678DD\"},children:\"return\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#E5C07B\"},children:\"res\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"status\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#D19A66\"},children:\"200\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\").\"}),(0,l.jsx)(e.span,{style:{color:\"#61AFEF\"},children:\"json\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"({ \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:\"tracks\"}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\" });\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"};\"})})]})})]}),`\n`,(0,l.jsxs)(e.p,{children:[`This will return the first ten top tracks, formatted to remove unnecessary information.\nFeel free to modify this as you see fit.\nIf everything worked correctly, you should see some data like this after running `,(0,l.jsx)(e.code,{children:\"next dev\"}),\".\"]}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"json\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.code,{\"data-language\":\"json\",\"data-theme\":\"default\",children:[(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"{\"})}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:'\"tracks\"'}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": [\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"    {\"})}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:'\"artist\"'}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:'\"Jamie xx\"'}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:'\"songUrl\"'}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:'\"https://open.spotify.com/track/77Ezu3tBE7gmzQ4mRnZZUf\"'}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:'\"title\"'}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:'\"The Rest Is Noise\"'})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"    },\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"    {\"})}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:'\"artist\"'}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:'\"Surfaces\"'}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:'\"songUrl\"'}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:'\"https://open.spotify.com/track/0NjSiGW8b5HYFfjdCbZzbg\"'}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#E06C75\"},children:'\"title\"'}),(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#98C379\"},children:'\"Horizons\"'})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"    }\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"  ]\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#ABB2BF\"},children:\"}\"})})]})})}),`\n`,(0,l.jsxs)(e.h2,{id:\"conclusion\",children:[(0,l.jsx)(e.a,{className:\"anchor\",href:\"#conclusion\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"The full source code is available \",(0,l.jsx)(e.a,{href:\"https://github.com/leerob/leerob.io/blob/675ba074e873a85f1ee6a0d195f7d20312e62b4e/lib/spotify.ts\",children:\"here\"}),\".\"]})]})}function E(n={}){let{wrapper:e}=n.components||{};return e?(0,l.jsx)(e,Object.assign({},n,{children:(0,l.jsx)(d,n)})):d(n)}var m=E;return g(D);})();\n;return Component;"
  },
  "_id": "spotify-api-nextjs.mdx",
  "_raw": {
    "sourceFilePath": "spotify-api-nextjs.mdx",
    "sourceFileName": "spotify-api-nextjs.mdx",
    "sourceFileDir": ".",
    "contentType": "mdx",
    "flattenedPath": "spotify-api-nextjs"
  },
  "type": "Blog",
  "slug": "spotify-api-nextjs",
  "tweetIds": [],
  "structuredData": {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "Using the Spotify API with Next.js",
    "datePublished": "2020-07-21",
    "dateModified": "2020-07-21",
    "description": "Learn how to authenticate with the Spotify API to fetch your top tracks in a Next.js API route.",
    "image": "https://homescree.net/og?title=Using the Spotify API with Next.js",
    "url": "https://homescree.net/blog/spotify-api-nextjs",
    "author": {
      "@type": "Person",
      "name": "Matthew Guo"
    }
  }
}